---
title             : "Psychopathy, borderline personality disorder, and emotional processing in incarcerated women"
shorttitle        : "psychopathy and psychopathology correlates in women"

author: 
  - name          : "Annalise S Halverson"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Postal address"
    email         : "asdh@uchicago.edu"
    role: # Contributorship roles (e.g., CRediT, https://credit.niso.org/)
      - "Conceptualization"
      - "Writing - Original Draft Preparation"
      - "Writing - Review & Editing"
  - name          : "Natalie Dowling"
    affiliation   : "1,2"
    role:
      - "Writing - Review & Editing"
      - "Supervision"

affiliation:
  - id            : "1"
    institution   : "University of Chicago"
  - id            : "2"
    institution   : "Department of Psychology"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  One or two sentences providing a **basic introduction** to the field,  comprehensible to a scientist in any discipline.
  Two to three sentences of **more detailed background**, comprehensible  to scientists in related disciplines.
  One sentence clearly stating the **general problem** being addressed by  this particular study.
  One sentence summarizing the main result (with the words "**here we show**" or their equivalent).
  Two or three sentences explaining what the **main result** reveals in direct comparison to what was thought to be the case previously, or how the  main result adds to previous knowledge.
  One or two sentences to put the results into a more **general context**.
  Two or three sentences to provide a **broader perspective**, readily comprehensible to a scientist in any discipline.
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "keywords"
wordcount         : "X"

bibliography      : "r-references.bib"

floatsintext      : yes
linenumbers       : yes
draft             : no
mask              : no

figurelist        : no
tablelist         : no
footnotelist      : no

classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
library(tidyverse)
library(diagram)
library(ggsci)
library(mediation)
library(stargazer)
library(mosaic)
r_refs("r-references.bib")
getwd()
setwd("../Documentation/")
theme_set(theme_classic(base_family = "serif"))
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
filtered_wide_data <- read.csv("filtered_wide_data.csv")
```

# Introduction

# Present Aims

``` {r simple plot of mediation relationship, echo=FALSE, out.width='100%'}

# this visual is to generically demonstrate the relationship i will be looking at

data <- c(0, "", 0,
          0, 0, 0, 
          "", "", 0)
M <- matrix (nrow=3, ncol=3, byrow = TRUE, data=data)
plot <- plotmat (M, pos=c(1,2), 
            name= c( "BPD","Psychopathy \n X \n Anxiety", "Alexithymia"), 
            box.type = "rect", box.size = 0.14, box.prop = 0.5,  curve = 0, arr.lwd = 1)

```

# Methods
We report how we determined our sample size, all data exclusions (if any), all manipulations, and all measures in the study. <!-- 21-word solution (Simmons, Nelson & Simonsohn, 2012; retrieved from http://ssrn.com/abstract=2160588) -->

## Participants

## Measures

## Procedure

## Data analysis
We used `r cite_r("r-references.bib")` for all our analyses. Due to the nature of the project, it was determined most ethical to simply remove participants who were missing data for any of the required assessments. A total of 104 participants remained.

# Results

Descriptive statistics for the assessments of interest can be seen in Table\ \@ref(tab:summary-table). <!-- it's not working idk why -->


``` {r summary-table, results = 'asis'}

minimal_descriptives <- filtered_wide_data[,c("PAIBOR_Total_Score", "PCLR_Total_Score_Prorated", "TAS_Total_Score", "STAI_Trait_Anxiety")]
view(minimal_descriptives)
stargazer(minimal_descriptives, header = FALSE, type = 'latex')

```

As seen in Figure\ \@ref(fig:PCLR-descriptives), our distribution of PCL--R scores is left-skewed, with more participants falling on the higher end of the spectrum.

(ref:PCLR-descriptives) Histogram of score distribution on the PCL--R.

``` {r, PCLR-descriptives, fig.cap="(ref:PCLR-descriptives)"}

#ggplot(data = filtered_wide_data, aes(x = PCLR_Total_Score_Prorated)) +
  #geom_density(color = "saddlebrown") +
  #ggtitle("Density Plot of Psychopathy") +
  #labs(x = "PCL-R", y = "Density") +
  #xlim(0,40)

ggplot(data = filtered_wide_data, aes(x = PCLR_Total_Score_Prorated)) +
  geom_histogram(fill = "magenta", color = "black", binwidth = 2) +
  scale_y_continuous(limits = c(0,12), breaks = seq(0, 12, 2)) +
  ggtitle("Histogram of Psychopathy") +
  labs(x = "PCL-R", y = "Count") +
  xlim(0,40)

```

```{r, STAI-descriptives}

#ggplot(data = filtered_wide_data, aes(x = STAI_Trait_Anxiety)) +
  #geom_density(color = "saddlebrown") +
  #ggtitle("Density Plot of Trait Anxiety") +
  #labs(x = "STAI_Trait", y = "Density") +
  #xlim(0,80)

### APPENDIX
ggplot(data = filtered_wide_data, aes(x = STAI_Trait_Anxiety)) +
  geom_histogram(fill = "magenta", color = "black", binwidth = 2) +
  scale_y_continuous(limits = c(0,10), breaks = seq(0, 10, 2)) +
  ggtitle("Histogram of Trait Anxiety") +
  labs(x = "STAI_Trait", y = "Count") +
  xlim(20,80)

```

```{r, PAI-descriptives}

#ggplot(data = filtered_wide_data, aes(x = PAIBOR_Total_Score)) +
  #geom_density(color = "saddlebrown") +
  #ggtitle("Density Plot of BPD") +
  #labs(x = "PAI-BOR", y = "Density") +
  #xlim(0,65)

### APPENDIX
ggplot(data = filtered_wide_data, aes(x = PAIBOR_Total_Score)) +
  geom_histogram(fill = "magenta", color = "black", binwidth = 2) +
  scale_y_continuous(limits = c(0,10), breaks = seq(0, 10, 2)) +
  ggtitle("Histogram of BPD") +
  labs(x = "PAI-BOR", y = "Count") +
  xlim(0,65)

```

```{r, TAS-descriptives}

#ggplot(data = filtered_wide_data, aes(x = TAS_Total_Score)) +
  #geom_density(color = "saddlebrown") +
  #ggtitle("Density Plot of Alexithymia") +
  #labs(x = "TAS", y = "Density") +
  #xlim(0,80)

### APPENDIX
ggplot(data = filtered_wide_data, aes(x = TAS_Total_Score)) +
  geom_histogram(fill = "magenta", color = "black", binwidth = 2) +
  scale_y_continuous(limits = c(0,10), breaks = seq(0, 10, 2)) +
  ggtitle("Histogram of Alexithymia") +
  labs(x = "TAS", y = "Count") +
  xlim(20,80)

```

Figure\ \@ref(fig:c-path-scatterplot) shows a moderate correlation between PsychopathyXAnxiety and Alexithymia.

(ref:c-path-caption) Scatterplot demonstrating relationship between the interactive term of psychopathy and trait anxiety with alexithymia in our sample of incarcerated women.

```{r c-path-scatterplot, fig.cap="(ref:c-path-caption)", echo=FALSE, out.width='100%'}

ggplot(filtered_wide_data, aes(x = PCLR_Total_Score_Prorated, y = TAS_Total_Score, color = STAI_Trait_Anxiety)) +
  geom_smooth(method = "lm", color = "black") +
  geom_point() +
  scale_color_gradient(low = "blue", high = "red") +
  labs(x = "Psychopathy X Anxiety", y = "Alexithymia", title = "Relationship between Psychopathy X Anxiety, Alexithymia")

#psytascorrelation <- cor(filtered_wide_data$PCLR_STAI_Trait, filtered_wide_data$TAS_Total_Score)
#print(psytascorrelation)

```

Figure\ \@ref(fig:a-path-scatterplot) shows a moderate to strong correlation between PsychopathyXAnxiety and BPD.

(ref:a-path-caption) Scatterplot demonstrating relationship between the interactive term of psychopathy and trait anxiety with borderline personality disorder in our sample of incarcerated women.

``` {r a-path-scatterplot, fig.cap="(ref:a-path-caption)", echo=FALSE, out.width='100%'}

ggplot(filtered_wide_data, aes(x = PCLR_Total_Score_Prorated, y = PAIBOR_Total_Score, color = STAI_Trait_Anxiety)) +
  geom_smooth(method = "lm", color = "black") +
  geom_point() + 
  scale_color_gradient(low = "blue", high = "red") +
  labs(x = "Psychopathy X Anxiety", y = "BPD", title = "Relationship between Psychopathy X Anxiety, BPD")

#psybpdcorrelation <- cor(filtered_wide_data$PCLR_STAI_Trait, filtered_wide_data$PAIBOR_Total_Score)
#print(psybpdcorrelation)

```

All assessment scores (including the interactive term) were standardized. Mediation analyses with bootstrapping were conducted to test the primary hypothesis. Unlike other methods, bootstrapping is not limited by the assumption of normality. The interaction term of PCL--R Total Score and STAI Trait Anxiety was entered as the predictor, and PAI-BOR Total Score was entered as the mediating term. Total Score on the TAS was our outcome variable. A significant Average Causal Mediation Effect (ACME) would demonstrate support of our hypothesis. Summary tables (figure out how to include this info) show that the ACME is significant and the Average Direct Effect (ADE) disappears. This implies full causal mediation by BPD on the relationship between PsychopathyXAnxiety and Alexithymia.

```{r, standardizing-variables}
###should this be in dataprep?###
filtered_wide_data$PAIBOR_Total_Score_z <-
  zscore(filtered_wide_data$PAIBOR_Total_Score)
filtered_wide_data$PCLR_STAI_Trait_z <-
  zscore(filtered_wide_data$PCLR_STAI_Trait)
filtered_wide_data$TAS_Total_Score_z <-
  zscore(filtered_wide_data$TAS_Total_Score)
filtered_wide_data$TAS_Factor1_Difficulty_Identifying_Feeling_z <-
  zscore(filtered_wide_data$TAS_Factor1_Difficulty_Identifying_Feeling)
filtered_wide_data$TAS_Factor2_Difficulty_Describing_Feelings_z <-
  zscore(filtered_wide_data$TAS_Factor2_Difficulty_Describing_Feelings)
filtered_wide_data$TAS_Factor3_Externally_Oriented_Thinking_z <-
  zscore(filtered_wide_data$TAS_Factor3_Externally_Oriented_Thinking)

```

In order to run a mediation analysis, one must ensure significant relationships exist between predictor and outcome, predictor and mediator, and mediator and outcome. Results for these preliminary analyses can be seen in some table somewhere.

``` {r prelim-regression-input, echo=FALSE, out.width='100%'}

po_path <- lm(TAS_Total_Score_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
pm_path <- lm(PAIBOR_Total_Score_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
mo_path <- lm(TAS_Total_Score_z ~ PAIBOR_Total_Score_z, data = filtered_wide_data)

```

``` {r prelim-regression-output, results = 'asis'}

stargazer(po_path, pm_path, mo_path, title = "Preliminary Regression Results", header = FALSE, type = 'latex', dep.var.labels = c("P-O Path", "P-M Path", "M-O Path"), covariate.labels = c("PsychopathyXAnxiety", "BPD"), column.sep.width = "1pt")

```

<!--
one analysis i will do is a simple linear regression where i use the interaction of psychopathy and anxiety to predict alexithymia (and it's 3 subfactors). i predict/require a significant relationship in order to proceed with a mediation analysis
-->

``` {r, simple-regression-input, echo=FALSE, out.width='100%'}

direct_model <- lm(TAS_Total_Score_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
direct_model1 <- lm(TAS_Factor1_Difficulty_Identifying_Feeling_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
direct_model2 <- lm(TAS_Factor2_Difficulty_Describing_Feelings_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
direct_model3 <- lm(TAS_Factor3_Externally_Oriented_Thinking_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)

```

```{r, simple-regression-output, results = 'asis'}

stargazer(direct_model, direct_model1, direct_model2, direct_model3, title = "Simple Linear Regression Results", header = FALSE, type = 'latex', dep.var.labels = c("TAS Total", "Factor 1", "Factor 2", "Factor 3"), covariate.labels = c("PsychopathyXAnxiety"), column.sep.width = "1pt")

```

<!--
a second analysis i will do is a multiple regression/mediation pathway. here, we are determining whether the presence of BPD symptoms may act as a mediator to the relationship between psychopathyXanxiety and alexithymia. a significant mediation effect + remaining significant direct effect means partial mediation, and a significant mediation effect + lacking significant direct effect means full mediation. no significant mediation effect means BPD would not act as a mediator in this relationship.
-->

```{r, mult-regression-input, echo=FALSE, out.width='100%'}
###should i keep the ugly plots??###
mediator_model_total <- lm(PAIBOR_Total_Score_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
model_total <- lm(TAS_Total_Score_z ~ PCLR_STAI_Trait_z + PAIBOR_Total_Score_z, data = filtered_wide_data)
mediation_result_total <- mediate(mediator_model_total, model_total, treat = "PCLR_STAI_Trait_z", mediator = "PAIBOR_Total_Score_z", boot=TRUE, sims=500)
#plot(mediation_result_total)
#summary(mediation_result_total) # full mediation?!

mediator_model_tasf1 <- lm(PAIBOR_Total_Score_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
model_tasf1 <- lm(TAS_Factor1_Difficulty_Identifying_Feeling_z ~ PCLR_STAI_Trait_z + PAIBOR_Total_Score_z, data = filtered_wide_data)
mediation_result_tasf1 <- mediate(mediator_model_tasf1, model_tasf1, treat = "PCLR_STAI_Trait_z", mediator = "PAIBOR_Total_Score_z", boot=TRUE, sims=500)
#plot(mediation_result_tasf1)
#summary(mediation_result_tasf1) # full mediation?!

mediator_model_tasf2 <- lm(PAIBOR_Total_Score_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
model_tasf2 <- lm(TAS_Factor2_Difficulty_Describing_Feelings_z ~ PCLR_STAI_Trait_z + PAIBOR_Total_Score_z, data = filtered_wide_data)
mediation_result_tasf2 <- mediate(mediator_model_tasf2, model_tasf2, treat = "PCLR_STAI_Trait_z", mediator = "PAIBOR_Total_Score_z", boot=TRUE, sims=500)
#plot(mediation_result_tasf2)
#summary(mediation_result_tasf2) # full mediation?!

mediator_model_tasf3 <- lm(PAIBOR_Total_Score_z ~ PCLR_STAI_Trait_z, data = filtered_wide_data)
model_tasf3 <- lm(TAS_Factor3_Externally_Oriented_Thinking_z ~ PCLR_STAI_Trait_z + PAIBOR_Total_Score_z, data = filtered_wide_data)
mediation_result_tasf3 <- mediate(mediator_model_tasf3, model_tasf3, treat = "PCLR_STAI_Trait_z", mediator = "PAIBOR_Total_Score_z", boot=TRUE, sims=500)
#plot(mediation_result_tasf3)
#summary(mediation_result_tasf3) # effect goes away... so interesting!!!!

```

```{r mult-regression-output, results = 'asis'}
### I CAN'T FIGURE OUT HOW TO COMBINE NICELY INTO ONE TABLE :(( ###
stargazer(model_total, model_tasf1, model_tasf2, model_tasf3, title = "Multiple Linear Regression Results", header = FALSE, type = 'latex', dep.var.labels = c("TAS Total", "Factor 1", "Factor 2", "Factor 3"), covariate.labels = c("PsychopathyXAnxiety", "BPD"), column.sep.width = "1pt")

```

There is a significant relationship between predictor (psychopathy and anxiety interaction) and outcome (alexithymia). However, this effect goes away when adding BPD as a mediator. This suggests that the presence of BPD acts as a mechanism through which the predictor influences the outcome. The significant, full mediation effect we observed suggests that a portion of the total effect of the predictor on the outcome is explained by the mediator.

Three subfactors defined in the TAS are believed to compose alexithymia: difficulty identifying feelings (Factor 1), difficulty describing feelings (Factor 2), and externally-oriented thinking (Factor 3). As we collected subfactor scores for every participant, we decided to conduct an exploratory analysis to get a sense of what specific parts of emotional processing psychopathy and BPD may be impacting. We found that, replacing the total TAS score for Factor 1 and Factor 2, the significant mediation effect remained in tact. However, designating Factor 3 as an outcome left us with an insignificant model. The change in significant effect when replacing for specific factors of TAS suggests the mediation effect may depend on specific aspects or dimensions of alexithymia. I would like to suggest some possible interpretations for this below:

It is possible that BPD symptoms uniquely impact certain dimensions of the outcome variable. When considering what each of the three factors represent, it may be plausible that BPD would affect factors 1 and 2 -- addressing emotional comprehension and recognition -- and not 3, as BPD may be more closely associated with internalizing features. More research that addresses the role of BPD on externally-oriented thinking is required here to draw firmer conclusions.

It is without a doubt that the relationship between psychopathy, anxiety, BPD, and alexithymia is multifaceted and complex. Our results should be further interpreted with caution and a unique sample such as this one may lead to skewed distributions.

Additional factors and moderators warrant further exploration. Other relevant comorbidities -- such as PTSD -- may influence the heterogeneous mediation pathway seen here in a way that could explain the nuanced relationships further. Further, it would certainly be worthwhile to break down BPD further to understand what specific mechanisms of this disorder might be at play in this relationship. We did not have sufficient data to conduct a factor analysis, but it may be useful as the personality disorder can be diagnosed in 256 unique ways, according to the DSM-V.

The heterogeneity of this mediation effect is certainly cause for future research. This information can guide the development of targeted interventions or strategies based on specific factors that are most influenced by the mediation process. This changes in significance emphasize the need for careful and nuanced interpretation, taking into account the specific characteristics and dynamics at play for each factor within the composite variables.

# Discussion

\newpage

# References

::: {#refs custom-style="Bibliography"}
:::
